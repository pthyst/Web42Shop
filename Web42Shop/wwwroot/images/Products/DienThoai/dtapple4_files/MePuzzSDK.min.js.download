!function(){var e,t,o,n=["https://www.gstatic.com/firebasejs/5.3.0/firebase-app.js","https://www.gstatic.com/firebasejs/5.3.0/firebase-messaging.js"],i="/MePuzzWorker.js",s="266761263864",a="https://mePuzz.com/api/",r=!1,c=navigator.platform,d=(document,navigator,screen,window),l=(d.encodeURIComponent,d.decodeURIComponent),m=function(){var e=navigator.language;if(e){var t=(e=e.toLowerCase()).split("-");if("zh"==t[0]){for(var o=0,n=L.TRADITIONAL_CHINESE_LANGUAGE_TAG;o<n.length;o++){var i=n[o];if(-1!==t.indexOf(i))return"zh-Hant"}for(var s=0,a=L.SIMPLIFIED_CHINESE_LANGUAGE_TAG;s<a.length;s++){var r=a[s];if(-1!==t.indexOf(r))return"zh-Hans"}return"zh-Hant"}return t[0].substring(0,2)}return"en"}(),u=L(navigator.userAgent),p=(o=u).mac?"Mac OS X":o.windows?"Microsoft Windows":o.windowsphone?"Microsoft Windows Phone":o.linux?"Linux":o.chromeos?"Google Chrome OS":o.android?"Google Android":o.ios?"Apple iOS":o.blackberry?"Blackberry":o.firefoxos?"Mozilla Firefox OS":o.webos?"WebOS":o.tizen?"Tizen":o.sailfish?"Sailfish OS":"Unknown",g=function(e){var t=e.mobile,o=e.tablet;return t?"Mobile":o?"Tablet":"Desktop"}(u),v=document.URL,w=document.referrer.split("/"),h=null,b={},y=["setAppId","track"];if(void 0!==w[2]&&""!==w[0]&&(h=w[0]+"//"+w[2]),void 0!==w[2]&&""!==w[0])h=w[0]+"//"+w[2];var z=function(e){B([arguments],y)};z.setAppId=function(t){e=t},z.track=function(t,o){let n=_(),i={method:"POST",headers:{"Content-Type":"application/json;charset=UTF-8","Access-Control-Allow-Origin":"*"},cache:"no-cache",mode:"no-cors",body:JSON.stringify({event:t,app:e,token:n,mepuzzId:I(),data:o,title:document.title,url:encodeURI(document.URL)})};fetch(a+"track",i)},z.framelessEventClick=function(t,o,n){let i=_(),s={method:"POST",headers:{"Content-Type":"application/json;charset=UTF-8","Access-Control-Allow-Origin":"*"},cache:"no-cache",mode:"no-cors",body:JSON.stringify({app:e,token:i,mepuzzId:I(),contentId:t})};fetch(a+"frameless-click",s).then(function(){(window.localStorage.setItem("displayFrameless",0),n)?window.open(o,"_blank").focus():window.location=o})};var k={getItem:function(e){return e&&this.hasItem(e)?unescape(document.cookie.replace(new RegExp("(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"),"$1")):null},setItem:function(e,t,o,n,i,s){if(e&&!/^(?:expires|max\-age|path|domain|secure)$/.test(e)){var a="";if(o)switch(typeof o){case"number":a="; max-age="+o;break;case"string":a="; expires="+o;break;case"object":a="; expires="+o.toGMTString()}document.cookie=escape(e)+"="+escape(t)+a+(i?"; domain="+i:"")+(n?"; path="+n:"")+(s?"; secure":"")}},removeItem:function(e){if(e&&this.hasItem(e)){var t=new Date;t.setDate(t.getDate()-1),document.cookie=escape(e)+"=; expires="+t.toGMTString()+"; path=/"}},hasItem:function(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)}};function I(){let e=window.localStorage.getItem("mepuzzId"),t=C(v,"mepuzzId");return t&&t.length>0?e!==t?(r=!0,window.localStorage.setItem("mepuzzId",t),t):e:e&&e.length>0?e:(e=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)),window.localStorage.setItem("mepuzzId",e),e)}function S(){firebase.initializeApp({messagingSenderId:s}),t=firebase.messaging(),"serviceWorker"in navigator&&navigator.serviceWorker.register(i,{scope:"/firebase-cloud-messaging-push-scope"}).then(function(e){t.useServiceWorker(e),e.update(),t.onTokenRefresh(function(){t.getToken().then(function(e){T(!1),x(e),O()}).catch(function(e){console.log("Unable to retrieve refreshed token ",e)})}),O(),function(){switch(C(v,"mepuzz").toLowerCase()){case"gettoken":_()}}()}).catch(function(e){console.log("Register service worker failed",e)})}function _(){return window.localStorage.getItem("token")}z.init=function(){var t=q[D];z.L=t&&t.l,z.loaded=!0;q[D]=z;if(t=t&&t.q)for(var o=0;o<t.length;o++)if("setAppId"===t[o][0]){e=t[o][1];break}!function(){let t=a+e+"/frameless";_()&&_().length>0&&(t+="?token="+_()),fetch(t).then(function(e){return f=e.status,e.json()}).then(function(t){if(1===t.success&&(!t.data||t.data.html))var o=setInterval(function(){if("complete"==document.readyState){clearInterval(o);let n=document.createElement("div");n.innerHTML=t.data.html,document.querySelector("body").appendChild(n),document.getElementById("mp-notification-button-close").addEventListener("click",function(){window.localStorage.setItem("displayFrameless",0),document.getElementById("mp-notification-"+e).classList.remove("mp-floating-cart-active")}),document.getElementById("mp-notification-button-open").addEventListener("click",function(){window.localStorage.setItem("displayFrameless",1),document.getElementById("mp-notification-"+e).classList.add("mp-floating-cart-active")}),"1"===window.localStorage.getItem("displayFrameless")?document.getElementById("mp-notification-"+e).classList.add("mp-floating-cart-active"):"0"===window.localStorage.getItem("displayFrameless")&&document.getElementById("mp-notification-"+e).classList.remove("mp-floating-cart-active")}},100)}).catch(function(e){console.log(e)})}(),I(),function(t){let o=k.getItem("mepuzzConfig");if(o)t(JSON.parse(o));else{let o=a+e+"/config";o+="?mepuzzId="+I(),fetch(o).then(function(e){return f=e.status,e.json()}).then(function(e){if(1===e.success&&(!e.payload.subdomain||e.payload.subdomain&&1===e.payload.subdomain.allow)){let t=new Date;t.setTime(t.getTime()+864e5),k.setItem("mepuzzConfig",JSON.stringify(e.payload),t)}t(e.payload)}).catch(function(e){console.log(e)})}}(function(e){let t=(b=e).app_status,o=b.app_domain,i=window.location.hostname.replace("www.","");if(t&&10===t&&o&&o.indexOf(i)>=0){let e=b.subdomain;e&&e.url.indexOf(i)<=0&&1===e.status?0===e.allow?function(e){if(E()){let t=window.localStorage.getItem("allowNotifSubdomain");if(!t||t&&"1"!==t){document.querySelector("head").innerHTML+='<link rel="stylesheet" href="https://static.mepuzz.com/sdk/v2/MePuzzSDKStyles.min.css" type="text/css"/>';let t="<div id='mepuzz-popover-container' class='mepuzz-popover-container mepuzz-reset slide-down'><div id='mepuzz-popover-dialog' class='mepuzz-popover-dialog'><div id='normal-popover'><div class='popover-body'><div class='popover-body-icon'><img alt='notification icon' class='' src='{logo}'></div><div class='popover-body-message'>{msg}</div><div class='clearfix'></div></div><div class='popover-footer'><button id='mepuzz-popover-allow-button' class='align-right primary popover-button'>ĐỒNG Ý</button><button id='mepuzz-popover-cancel-button' class='align-right secondary popover-button'>KHÔNG ĐỒNG Ý</button><div class='clearfix'></div></div></div></div></div>";t=(t=t.replace("{logo}",e.logo)).replace("{msg}",e.msg);let o=document.createElement("div");o.innerHTML=t,document.querySelector("body").appendChild(o),document.getElementById("mepuzz-popover-allow-button").addEventListener("click",function(){window.localStorage.setItem("allowNotifSubdomain",1),document.getElementById("mepuzz-popover-container").style.display="none";let t=e.url+"?mepuzzId="+I();window.open(t,"","height=400,width=600")}),document.getElementById("mepuzz-popover-cancel-button").addEventListener("click",function(){let e=new Date;e.setTime(e.getTime()+864e5),k.setItem("flag_not_ask_allow_in_day",new Date,e),document.getElementById("mepuzz-popover-container").style.display="none"})}}}(e):j&&B(j,y):(s=S,a=n,function e(){if(a.length){var t=a.shift(),o=document,n=o.createElement("script"),i=o.getElementsByTagName("script")[0];n.type="text/javascript",n.async=!0,n.defer=!0,n.onload=n.onreadystatechange=function(e,t){var o=!1;return function(){o||this.readyState&&"complete"!=this.readyState||(o=!0,t())}}(0,e),n.src=t,i.parentNode.insertBefore(n,i)}else s()}())}var s,a})};var x=function(t){((function(e){let t=window.localStorage.getItem("token");return t&&t.length>0?t!==e&&(window.localStorage.setItem("token",e),!0):(window.localStorage.setItem("token",e),!0)})(t)||r)&&(null!==window.sessionStorage.getItem("localtion")?(window.ClientLocation=JSON.parse(window.sessionStorage.getItem("localtion")),N(t,window.ClientLocation)):new Promise(function(t,o){try{let o=a+e+"/localtion";fetch(o).then(function(e){return f=e.status,e.json()}).then(function(e){t(e)}).catch(function(e){t("")})}catch(e){t("")}}).then(function(e){window.ClientLocation=e,window.sessionStorage.setItem("localtion",JSON.stringify(e)),N(t,e)},function(e){console.log(e),N(t,null)}))},T=function(e){window.localStorage.setItem("sendToServer",e?"1":"0")};function O(){t.getToken().then(function(e){e?(e,x(e),j&&B(j,y)):(T(!1),E()&&t.requestPermission().then(function(){O()}).catch(function(e){console.log("Unable to get permission to notify.",e),A()}))}).catch(function(e){console.log("An error occurred while retrieving token. ",e),T(!1)})}function E(){let e=JSON.parse(k.getItem("mepuzzConfig")),t=!1,o=k.getItem("flag_not_ask_allow_in_day");if(e&&e.not_ask_allow_in_day&&1===e.not_ask_allow_in_day||o){let e=new Date;if(o){let n=new Date(e.getYear(),e.getMonth(),e.getDay());new Date(new Date(o).getYear(),new Date(o).getMonth(),new Date(o).getDay())>n&&(e.setTime(e.getTime()+864e5),k.setItem("flag_not_ask_allow_in_day",new Date,e),t=!0)}else e.setTime(e.getTime()+864e5),k.setItem("flag_not_ask_allow_in_day",new Date,e),t=!0}else t=!0;return"Apple iOS"===p&&(t=!1),u.name.indexOf("Safari")>=0&&(t=!1),t}function N(t,o){let n="",s="",r="",d="",l="",f="",w="";if(o)try{void 0!==o.query&&(n=o.query),void 0!==o.city&&(s=o.city),void 0!==o.countryCode&&(r=o.countryCode),void 0!==o.country&&(d=o.country),void 0!==o.lat&&(l=o.lat),void 0!==o.lon&&(f=o.lon),void 0!==o.timezone&&(w=o.timezone)}catch(e){}var y={method:"POST",headers:{"Content-Type":"application/json;charset=UTF-8","Access-Control-Allow-Origin":"*"},cache:"no-cache",mode:"no-cors",body:JSON.stringify({language:m,subscription_id:t,mepuzzId:I(),device_os:u.version,browser_name:u.name,browser_version:u.version,operating_system:p,operating_system_version:u.osversion,device_platform:g,device_model:c,ip:n,city:s,country_code:r,country_name:d,latitude:l,longitude:f,time_zone:w,url:encodeURI(v),url_ref:encodeURI(h),utm_source:C(v,"utm_source"),sdk_version:2})};return fetch(a+e+"/subscribe",y).then(function(e){return e.status}).then(function(e){if(200===e||0===e){T(!0);let e=b.notif_wellcome?b.notif_wellcome.status:0;if(b&&1===e){let t=window.localStorage.getItem("notif_wellcome");if(!t||t&&"1"!==t){window.localStorage.setItem("notif_wellcome",e);let t=b.notif_wellcome.data,o={body:t.body,icon:t.icon,image:t.image,data:{url:t.url,notif_id:0},requireInteraction:!0};navigator.serviceWorker.register(i,{scope:"/firebase-cloud-messaging-push-scope"}).then(function(e){e.showNotification(t.title,o).onclick=function(e){e.preventDefault(),window.open(t.url,"_blank").focus()}}),A()}A()}A()}}).catch(function(e){console.log(e),A()})}function A(){C(v,"mepuzzId")&&window.close()}function C(e,t){var o=new RegExp("[\\?&#]"+t+"=([^&#]*)").exec(e);return o?l(o[1]):""}function P(){var e,t,o;for(e=0;e<arguments.length;e+=1){null,arguments[e]&&arguments[e].slice&&arguments[e].slice();for(var n=[],i=arguments[e],s=0;s<i.length;s++)n.push(i[s]);t=(o=n).shift(),z[t]&&z[t].apply(z,o)}}function B(e,t){var o,n,i={};for(o=0;o<t.length;o++){var s=t[o];for(i[s]=1,n=0;n<e.length;n++)if(e[n]&&e[n][0]){var a=e[n][0];s===a&&(P(e[n]),delete e[n],i[a]++)}}return e}function L(e){var t=!0;function o(t){var o=e.match(t);return o&&o.length>1&&o[1]||""}var n,i=o(/(ipod|iphone|ipad)/i).toLowerCase(),s=!/like android/i.test(e)&&/android/i.test(e),a=/nexus\s*[0-6]\s*/i.test(e),r=!a&&/nexus\s*[0-9]+/i.test(e),c=/CrOS/.test(e),d=/silk/i.test(e),l=/sailfish/i.test(e),m=/tizen/i.test(e),u=/(web|hpw)os/i.test(e),p=/windows phone/i.test(e),f=(/SamsungBrowser/i.test(e),!p&&/windows/i.test(e)),g=!i&&!d&&/macintosh/i.test(e),v=!s&&!l&&!m&&!u&&/linux/i.test(e),w=o(/edge\/(\d+(\.\d+)?)/i),h=o(/version\/(\d+(\.\d+)?)/i),b=/tablet/i.test(e)&&!/tablet pc/i.test(e),y=!b&&/[^-]mobi/i.test(e),z=/xbox/i.test(e);/opera/i.test(e)?n={name:"Opera",opera:t,version:h||o(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(e)?n={name:"Opera",opera:t,version:o(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||h}:/SamsungBrowser/i.test(e)?n={name:"Samsung Internet for Android",samsungBrowser:t,version:h||o(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/coast/i.test(e)?n={name:"Opera Coast",coast:t,version:h||o(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/yabrowser/i.test(e)?n={name:"Yandex Browser",yandexbrowser:t,version:h||o(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(e)?n={name:"UC Browser",ucbrowser:t,version:o(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(e)?n={name:"Maxthon",maxthon:t,version:o(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(e)?n={name:"Epiphany",epiphany:t,version:o(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(e)?n={name:"Puffin",puffin:t,version:o(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(e)?n={name:"Sleipnir",sleipnir:t,version:o(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(e)?n={name:"K-Meleon",kMeleon:t,version:o(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:p?(n={name:"Windows Phone",windowsphone:t},w?(n.msedge=t,n.version=w):(n.msie=t,n.version=o(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(e)?n={name:"Internet Explorer",msie:t,version:o(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:c?n={name:"Chrome",chromeos:t,chromeBook:t,chrome:t,version:o(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/chrome.+? edge/i.test(e)?n={name:"Microsoft Edge",msedge:t,version:w}:/vivaldi/i.test(e)?n={name:"Vivaldi",vivaldi:t,version:o(/vivaldi\/(\d+(\.\d+)?)/i)||h}:l?n={name:"Sailfish",sailfish:t,version:o(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(e)?n={name:"SeaMonkey",seamonkey:t,version:o(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(e)?(n={name:"Firefox",firefox:t,version:o(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(e)&&(n.firefoxos=t)):d?n={name:"Amazon Silk",silk:t,version:o(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(e)?n={name:"PhantomJS",phantom:t,version:o(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(e)?n={name:"SlimerJS",slimer:t,version:o(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(e)||/rim\stablet/i.test(e)?n={name:"BlackBerry",blackberry:t,version:h||o(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:u?(n={name:"WebOS",webos:t,version:h||o(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(e)&&(n.touchpad=t)):/bada/i.test(e)?n={name:"Bada",bada:t,version:o(/dolfin\/(\d+(\.\d+)?)/i)}:m?n={name:"Tizen",tizen:t,version:o(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||h}:/qupzilla/i.test(e)?n={name:"QupZilla",qupzilla:t,version:o(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||h}:/chromium/i.test(e)?n={name:"Chromium",chromium:t,version:o(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||h}:/chrome|crios|crmo/i.test(e)?n={name:"Chrome",chrome:t,version:o(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:s?n={name:"Android",version:h}:/safari|applewebkit/i.test(e)?(n={name:"Safari",safari:t},h&&(n.version=h)):i?(n={name:"iphone"==i?"iPhone":"ipad"==i?"iPad":"iPod"},h&&(n.version=h)):n=/googlebot/i.test(e)?{name:"Googlebot",googlebot:t,version:o(/googlebot\/(\d+(\.\d+))/i)||h}:{name:o(/^(.*)\/(.*) /),version:function(t){var o=e.match(/^(.*)\/(.*) /);return o&&o.length>1&&o[2]||""}()},!n.msedge&&/(apple)?webkit/i.test(e)?(/(apple)?webkit\/537\.36/i.test(e)?(n.name=n.name||"Blink",n.blink=t):(n.name=n.name||"Webkit",n.webkit=t),!n.version&&h&&(n.version=h)):!n.opera&&/gecko\//i.test(e)&&(n.name=n.name||"Gecko",n.gecko=t,n.version=n.version||o(/gecko\/(\d+(\.\d+)?)/i)),n.windowsphone||n.msedge||!s&&!n.silk?n.windowsphone||n.msedge||!i?g?n.mac=t:z?n.xbox=t:f?n.windows=t:v&&(n.linux=t):(n[i]=t,n.ios=t):n.android=t;var k="";n.windows?k=function(e){switch(o(/Windows ((NT|XP)( \d\d?.\d)?)/i)){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}():n.windowsphone?k=o(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):n.mac?k=(k=o(/Mac OS X (\d+([_\.\s]\d+)*)/i)).replace(/[_\s]/g,"."):i?k=(k=o(/os (\d+([_\s]\d+)*) like mac os x/i)).replace(/[_\s]/g,"."):s?k=o(/android[ \/-](\d+(\.\d+)*)/i):n.webos?k=o(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):n.blackberry?k=o(/rim\stablet\sos\s(\d+(\.\d+)*)/i):n.bada?k=o(/bada\/(\d+(\.\d+)*)/i):n.tizen&&(k=o(/tizen[\/\s](\d+(\.\d+)*)/i)),k&&(n.osversion=k);var I=!n.windows&&k.split(".")[0];return b||r||"ipad"==i||s&&(3==I||I>=4&&!y)||n.silk?n.tablet=t:(y||"iphone"==i||"ipod"==i||s||a||n.blackberry||n.webos||n.bada)&&(n.mobile=t),n.msedge||n.msie&&n.version>=10||n.yandexbrowser&&n.version>=15||n.vivaldi&&n.version>=1||n.chrome&&n.version>=20||n.samsungBrowser&&n.version>=4||n.firefox&&n.version>=20||n.safari&&n.version>=6||n.opera&&n.version>=10||n.ios&&n.osversion&&n.osversion.split(".")[0]>=6||n.blackberry&&n.version>=10.1||n.chromium&&n.version>=20?n.a=t:n.msie&&n.version<10||n.chrome&&n.version<20||n.firefox&&n.version<20||n.safari&&n.version<6||n.opera&&n.version<10||n.ios&&n.osversion&&n.osversion.split(".")[0]<6||n.chromium&&n.version<20?n.c=t:n.x=t,n}db=function(){};var M,D=null!=(M=window.MePuzzAnalyticsObject)&&-1<(M.constructor+"").indexOf("String")&&function(e){return e?e.replace(/^[\s\xa0]+|[\s\xa0]+$/g,""):""}(window.MePuzzAnalyticsObject)||"mePuzz",q=window,j=(document,q[D]);if(j=j&&j.q,"undefined"!=typeof appId&&void 0===j)e=appId;else if("undefined"!=typeof _mepuzzPaq&&void 0===j){for(var U=0;U<_mepuzzPaq.length;U++)if("setAppId"===_mepuzzPaq[U][0]){e=_mepuzzPaq[U][1];break}}else if("undefined"!=typeof _paq&&void 0===j)for(U=0;U<_paq.length;U++)if("setAppId"===_paq[U][0]){e=_paq[U][1];break}(0,z.init)()}(window);